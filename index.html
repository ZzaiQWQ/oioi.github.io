<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zzai OS - Virtual Desktop ğŸŒ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 
      ==== ğŸš€ æœ¬åœ°å¤šç›¸å†Œé…ç½®è¯´æ˜ ====
      
      1. æ–‡ä»¶ç»“æ„ç¤ºä¾‹ï¼š
         /root
           â”œâ”€â”€ index.html
           â”œâ”€â”€ photos.js
           â””â”€â”€ images/
                 â”œâ”€â”€ travel/   (å¯¹åº”ä¸‹é¢çš„ folder: 'travel')
                 â”‚    â”œâ”€â”€ 1.jpg
                 â”‚    â””â”€â”€ 2.jpg
                 â””â”€â”€ pets/     (å¯¹åº”ä¸‹é¢çš„ folder: 'pets')
                      â””â”€â”€ cat.png

      2. åœ¨ photos.js ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š
         window.MY_ALBUMS = [
           {
             name: "æ—…è¡Œæ—¥è®° âœˆï¸",
             folder: "travel",  
             files: ["1.jpg", "2.jpg"]
           },
           {
             name: "æ¯›å­©å­ ğŸ±",
             folder: "pets",
             files: ["cat.png"]
           }
         ];
    -->
    <script src="photos.js"></script>

    <!-- ğŸ‘‡ åœ¨çº¿æ¼”ç¤ºæ•°æ® (æœ¬åœ°è¿è¡Œæ—¶è¯·åˆ é™¤æ­¤ script å—) ğŸ‘‡ -->
    <script>
        // å¦‚æœæ²¡æœ‰ photos.jsï¼Œè¿™é‡Œæä¾›æ¼”ç¤ºç”¨çš„å¤šç›¸å†Œæ•°æ®
        if (!window.MY_ALBUMS) {
            window.MY_ALBUMS = [
                {
                    name: "æ²»æ„ˆé£æ™¯ ğŸ”ï¸",
                    folder: "demo_scenery", 
                    files: [
                        "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=500&q=80",
                        "https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=500&q=80",
                        "https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=500&q=80"
                    ]
                },
                {
                    name: "åŸå¸‚è§’è½ ğŸ™ï¸",
                    folder: "demo_city",
                    files: [
                        "https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=500&q=80",
                        "https://images.unsplash.com/photo-1519501025264-65ba15a82390?w=500&q=80"
                    ]
                },
                {
                    name: "å¯çˆ±åŠ¨ç‰© ğŸ¾",
                    folder: "demo_pets",
                    files: [
                        "https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?w=500&q=80",
                        "https://images.unsplash.com/photo-1573865526739-10659fec78a5?w=500&q=80",
                        "https://images.unsplash.com/photo-1533738363-b7f9aef128ce?w=500&q=80"
                    ]
                }
            ];
        }
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;900&family=VT323&family=Indie+Flower&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'cute': ['"M PLUS Rounded 1c"', 'sans-serif'],
                        'pixel': ['"VT323"', 'monospace'],
                        'hand': ['"Indie Flower"', 'cursive'],
                    },
                    colors: {
                        'zzai': '#ff9eb5', // è°ƒæš—äº†ç²‰è‰²
                        'zzai-dark': '#ff7593', // è°ƒæš—äº†ç²‰è‰²æ·±è‰²
                        'sky-blue': '#7dc4e0', // è°ƒæš—äº†è“è‰²
                        'sky-dark': '#009acd', // è°ƒæš—äº†è“è‰²æ·±è‰²
                    },
                    animation: {
                        'breathe': 'breathe 3s infinite alternate ease-in-out',
                        'walk-bob': 'walk-bob 0.4s infinite alternate ease-in-out',
                        'wag': 'wag 1s infinite alternate ease-in-out',
                        'pop': 'pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)',
                    }
                }
            }
        }
    </script>
    <style>
        body { 
            margin: 0; overflow: hidden; 
            font-family: 'M PLUS Rounded 1c', sans-serif;
            /* è‡ªå®šä¹‰å…‰æ ‡ */
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="%23ff7593" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"/></svg>') 12 12, auto;
        }

        .desktop-wallpaper {
            transition: all 0.5s ease;
            background-size: 50px 50px;
        }
        /* è°ƒæš—äº†èƒŒæ™¯è‰²ï¼Œå‡å°‘åˆºçœ¼æ„Ÿ */
        .theme-zzai {
            background-color: #ffe0e9; 
            background-image: 
                linear-gradient(rgba(255, 150, 170, 0.15) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 150, 170, 0.15) 1px, transparent 1px);
        }
        .theme-sky {
            background-color: #dbeafe; 
            background-image: 
                linear-gradient(rgba(100, 180, 230, 0.15) 1px, transparent 1px),
                linear-gradient(90deg, rgba(100, 180, 230, 0.15) 1px, transparent 1px);
        }

        /* é™ä½äº†çª—å£çš„ä¸é€æ˜åº¦ï¼Œå‡å°‘å¤§é¢ç§¯çº¯ç™½ */
        .glass-window {
            background: rgba(255, 255, 255, 0.70);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
        }

        .cursor-trail {
            pointer-events: none; position: fixed;
            width: 10px; height: 10px; border-radius: 50%;
            animation: fadeOut 0.8s forwards; z-index: 9999;
        }
        @keyframes fadeOut {
            0% { transform: scale(1); opacity: 0.8; }
            100% { transform: scale(0.1); opacity: 0; transform: translateY(15px); }
        }

        @keyframes breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }
        @keyframes walk-bob { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-3px); } }
        @keyframes wag { from { transform: rotate(-20deg); } to { transform: rotate(-10deg); } }
        @keyframes pop { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

        .pixelated { image-rendering: pixelated; }
        .scroll-container::-webkit-scrollbar { width: 6px; }
        .scroll-container::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

        .cat-container {
            position: fixed;
            bottom: 52px; 
            z-index: 60;
            transition: left 4000ms ease-in-out;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- é¼ æ ‡å°¾è¿¹æ•ˆæœ ---
        const CursorEffect = ({ theme }) => {
            useEffect(() => {
                const handleMove = (e) => {
                    if (Math.random() > 0.25) return; 
                    const p = document.createElement('div');
                    p.className = 'cursor-trail';
                    p.style.left = e.clientX + 'px'; p.style.top = e.clientY + 'px';
                    const colors = theme === 'zzai' 
                        ? ['#ff9eb5', '#ff7593', '#ffc107', '#f472b6'] 
                        : ['#7dc4e0', '#60a5fa', '#ffffff', '#93c5fd'];
                    p.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    document.body.appendChild(p);
                    setTimeout(() => p.remove(), 800);
                };
                window.addEventListener('mousemove', handleMove);
                return () => window.removeEventListener('mousemove', handleMove);
            }, [theme]);
            return null;
        };

        // --- å›¾æ ‡å®šä¹‰ ---
        const ICONS = {
            os: <path d="M3 3h7v7H3zM14 3h7v7h-7zM14 14h7v7h-7zM3 14h7v7H3z" />,
            library: <><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" /><path d="M2 11h20l-2 8H4l-2-8z" /></>,
            home: <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />,
            cloud: <path d="M17.5 19c3.037 0 5.5-2.463 5.5-5.5 0-2.613-1.826-4.799-4.256-5.352a7.001 7.001 0 0 0-13.488 0C2.826 8.701 1 10.887 1 13.5 1 16.537 3.463 19 6.5 19h11z" />,
            monitor: <><rect x="2" y="3" width="20" height="14" rx="2" ry="2" /><line x1="8" y1="21" x2="16" y2="21" /><line x1="12" y1="17" x2="12" y2="21" /></>,
            folder: <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" />
        };

        const Icon = ({ path, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {path}
            </svg>
        );

        // --- æ¡Œé¢å›¾æ ‡ç»„ä»¶ ---
        const DesktopIcon = ({ label, icon, onClick, theme, isSvg = false }) => {
            // åŠ æ·±äº†å›¾æ ‡é¢œè‰²å’Œè¾¹æ¡†ï¼Œå‡å°‘ç™½åº•çš„ä¸é€æ˜åº¦
            const baseColor = theme === 'zzai' ? 'from-pink-100 to-white/80 text-pink-500 border-pink-200' : 'from-blue-100 to-white/80 text-blue-500 border-blue-200';
            return (
                <div className="flex flex-col items-center gap-1 w-20 group cursor-pointer p-2 rounded hover:bg-white/30 transition-all duration-300" onClick={onClick}>
                    <div className={`w-13 h-13 bg-gradient-to-br ${baseColor} rounded-2xl shadow-sm flex items-center justify-center text-3xl group-hover:scale-110 group-hover:shadow-md transition-all border border-opacity-50`}>
                        {isSvg ? <Icon path={icon} className="w-8 h-8" /> : icon}
                    </div>
                    {/* æ–‡å­—èƒŒæ™¯æ›´é€æ˜ï¼Œæ–‡å­—é¢œè‰²æ›´æ·± */}
                    <span className="text-[10px] font-bold text-gray-700 bg-white/50 px-2 py-0.5 rounded-full shadow-sm backdrop-blur-sm whitespace-nowrap border border-white/30">{label}</span>
                </div>
            );
        };

        // --- å¾…åŠäº‹é¡¹ä¾¿ç­¾ ---
        const TodoMemo = () => {
            const [tasks, setTasks] = useState([]);
            const taskPool = [
                ["æ•´ç†ç›¸å†Œå†…çš„å°æƒŠå–œ ğŸ“·", "ç»™åƒç´ çŒ«æŠ•å–‚å°é±¼å¹² ğŸŸ", "å‘ç°ä¸€å¼ å€¼å¾—å›å¿†çš„ç…§ç‰‡ ğŸï¸"],
                ["é™ªä¸‰èŠ±çŒ«åœ¨åœ°æ¿å‘å‘† â˜ï¸", "å–æ¯æ¸©æ°´æ¶¦æ¶¦å—“å­ ğŸ’§", "å†™ä¸‹ä»Šæ—¥çš„ä¸€ä»¶ä¹äº‹ ğŸ“"]
            ];
            useEffect(() => {
                const today = new Date().getDate();
                const index = today % taskPool.length;
                setTasks(taskPool[index].map((text, i) => ({ id: i, text, done: false })));
            }, []);
            const toggle = (id) => setTasks(tasks.map(t => t.id === id ? {...t, done: !t.done} : t));
            // è°ƒæš—äº†ä¾¿ç­¾çš„é»„è‰²èƒŒæ™¯
            return (
                <div className="fixed top-8 right-8 w-60 bg-gradient-to-b from-[#fef3c7] to-[#fffbeb] shadow-xl transform rotate-1 p-5 font-hand text-gray-700 hidden lg:block z-[100] border-l-4 border-[#fcd34d] transition-all duration-300 hover:rotate-0 hover:scale-110 origin-top-right">
                    <div className="absolute -top-3 left-1/2 -translate-x-1/2 w-16 h-8 bg-white/40 rotate-1 shadow-sm rounded"></div>
                    <h3 className="font-bold text-center border-b-2 border-gray-500/10 pb-2 mb-3 text-lg text-gray-800">ä»Šæ—¥ä»»åŠ¡</h3>
                    <ul className="space-y-3 text-md">
                        {tasks.map(t => (
                            <li key={t.id} className="flex items-start gap-2 cursor-pointer" onClick={() => toggle(t.id)}>
                                <div className={`w-4 h-4 mt-1 border-2 border-gray-400 rounded flex-shrink-0 flex items-center justify-center transition-colors ${t.done ? 'bg-pink-500 border-pink-500' : ''}`}>
                                    {t.done && <span className="text-[10px] text-white font-bold">âœ”</span>}
                                </div>
                                <span className={`${t.done ? 'line-through opacity-40' : ''}`}>{t.text}</span>
                            </li>
                        ))}
                    </ul>
                </div>
            );
        };

        // --- åƒç´ çŒ«ç»„ä»¶ ---
        const RealisticPixelCat = () => {
            const [x, setX] = useState(window.innerWidth > 0 ? window.innerWidth - 250 : 500);
            const [actionState, setActionState] = useState('idle');
            const [direction, setDirection] = useState('left');
            const [message, setMessage] = useState(null);
            const messageTimerRef = useRef(null);

            const phrases = {
                idle: ["å–µå‘œï¼Œå‘å‘†ä¸­... ğŸŸ", "ä½ å¥½å‘€ï¼Œäººç±» âœ¨", "è¹­è¹­~ â¤ï¸"],
                walk: ["å·¡é€»ä¸­... ğŸ¾", "å‘ç°ä¸€ä¸ªçº¢ç‚¹ï¼", "æºœè¾¾æºœè¾¾~"],
                sit: ["è¿™é‡Œçš„è§†é‡ä¸é”™ â˜ï¸", "åç€çœ‹ä½ å¿™ç¢Œ"],
                lay: ["å¥½å›°å‘€... Zzz", "è¶´ä¸€ä¼šå„¿ï¼Œåˆ«åµé†’æˆ‘"]
            };

            const showMessage = (text) => {
                if (messageTimerRef.current) clearTimeout(messageTimerRef.current);
                setMessage(text);
                messageTimerRef.current = setTimeout(() => {
                    setMessage(null);
                    messageTimerRef.current = null;
                }, 3000);
            };

            useEffect(() => {
                const loop = () => {
                    const rand = Math.random();
                    if (rand < 0.5) {
                        const targetX = Math.random() * (window.innerWidth - 250) + 100;
                        setX(prevX => {
                            setDirection(targetX > prevX ? 'right' : 'left');
                            return prevX; 
                        });
                        setActionState('walk');
                        setTimeout(() => setX(targetX), 50);
                        setTimeout(() => setActionState('idle'), 4050);
                    } 
                    else if (rand < 0.7) {
                        setActionState('sit');
                        if (Math.random() > 0.5) showMessage(phrases.sit[Math.floor(Math.random() * phrases.sit.length)]);
                    }
                    else if (rand < 0.85) {
                        setActionState('lay');
                        if (Math.random() > 0.5) showMessage(phrases.lay[Math.floor(Math.random() * phrases.lay.length)]);
                    }
                    else {
                        setActionState('idle');
                        if (Math.random() > 0.6) showMessage(phrases.idle[Math.floor(Math.random() * phrases.idle.length)]);
                    }
                };
                const interval = setInterval(loop, 6000);
                return () => clearInterval(interval);
            }, []);

            const getBodyTransform = () => {
                if (actionState === 'sit') return 'rotate(16deg)'; 
                if (actionState === 'lay') return 'translateY(16px) scaleY(0.55) scaleX(1.05)';
                return 'translateY(0)';
            };

            const getHeadTransform = () => {
                if (actionState === 'sit') return 'translateY(4px) translateX(-1px) scale(0.9)'; 
                if (actionState === 'lay') return 'translateY(24px) scale(0.75)'; 
                return 'translateY(0)';
            };

            const getBubbleShift = () => {
                if (actionState === 'lay') return 'translateY(20px)';
                if (actionState === 'sit') return 'translateY(5px)';
                return 'translateY(0)';
            };

            return (
                <div className="cat-container pointer-events-none" style={{ left: `${x}px` }}>
                    <div className="relative pointer-events-auto cursor-pointer group" 
                         onClick={() => showMessage("æŠ“åˆ°ä½ äº†ï¼å–µ~ ğŸ¾")}
                         style={{ transform: direction === 'right' ? 'scaleX(-1)' : 'scaleX(1)' }}>
                        <div className={`absolute -top-16 left-1/2 bg-white/90 px-4 py-2 rounded-2xl shadow-xl text-xs font-bold border-2 border-pink-200 whitespace-nowrap transition-all duration-500 ${message ? 'opacity-100' : 'opacity-0 translate-y-2'}`}
                             style={{ transform: `${direction === 'right' ? 'translate(-50%, 0) scaleX(-1)' : 'translate(-50%, 0)'} ${getBubbleShift()}` }}>
                            {message}
                            <div className="absolute -bottom-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white/90 border-b-2 border-r-2 border-pink-200 rotate-45"></div>
                        </div>
                        <svg width="80" height="60" viewBox="0 0 60 45" className={`pixelated ${actionState === 'walk' ? 'animate-walk-bob' : 'animate-breathe'}`} style={{ transition: 'transform 0.5s ease' }}>
                            <ellipse cx="30" cy="42" rx="22" ry="4" fill="rgba(0,0,0,0.15)" />
                            <rect x="38" y="35" width="5" height="8" fill="#FFFFFF" style={{ transition: 'opacity 0.3s ease', opacity: actionState === 'lay' ? 0 : 1 }} />
                            <g style={{ transition: 'opacity 0.3s ease', opacity: actionState === 'lay' ? 0 : 1 }}>
                                <rect x="18" y="35" width="5" height="8" fill="#FFFFFF" />
                                <rect x="28" y="35" width="5" height="8" fill="#FFFFFF" />
                            </g>
                            <g style={{ transform: getBodyTransform(), transition: 'transform 0.5s ease', transformOrigin: '18px 35px' }}>
                                <path d="M15 15h30v20H15z" fill="#FFFFFF" />
                                <path d="M15 15h12v12H15z" fill="#FFCC99" /> 
                                <path d="M35 25h10v10H35z" fill="#664433" /> 
                                <path d="M45 30h12v6h-12z" fill="#FFFFFF" transform="rotate(-20 45 30)" className="origin-left animate-wag" />
                            </g>
                            <g style={{ transform: getHeadTransform(), transition: 'transform 0.5s ease', transformOrigin: '22px 22px' }}>
                                <path d="M10 5h22v22H10z" fill="#FFFFFF" />
                                <path d="M10 5h10v10H10z" fill="#FFCC99" /> 
                                <path d="M10 0h6v5h-6zM26 0h6v5h-6z" fill="#FFFFFF" />
                                <path d="M11 1h4v4h-4z" fill="#FFDDEE" />
                                <path d="M27 1h4v4h-4z" fill="#FFDDEE" />
                                <rect x="14" y="13" width="4" height="4" fill="#333333" />
                                <rect x="24" y="13" width="4" height="4" fill="#333333" />
                                <rect x="14" y="13" width="1" height="1" fill="#FFFFFF" />
                                <rect x="24" y="13" width="1" height="1" fill="#FFFFFF" />
                                <rect x="20" y="19" width="2" height="1" fill="#FF99AA" />
                            </g>
                        </svg>
                    </div>
                </div>
            );
        };

        // --- ä¸»åº”ç”¨çª—å£ ---
        const MainAppWindow = ({ activeTab, onTabChange, onClose, albums, currentAlbum, setCurrentAlbum, setSelectedPhoto, theme }) => {
            // ä¾§è¾¹æ å’Œé«˜äº®é¢œè‰²åŠ æ·±
            const sidebarHighlight = theme === 'zzai' ? 'bg-pink-100 text-pink-700' : 'bg-blue-100 text-blue-700';
            const headerGradient = theme === 'zzai' ? 'from-white/60 to-pink-100/40' : 'from-white/60 to-blue-100/40';
            const folderColor = theme === 'zzai' ? 'bg-pink-100/80 text-pink-500' : 'bg-blue-100/80 text-blue-500';

            const handlePhotoTabClick = () => {
                onTabChange('photos');
                setCurrentAlbum(null); 
            };

            const getBreadcrumb = () => {
                if (activeTab !== 'photos') return 'Instructions';
                if (!currentAlbum) return 'Photos / All Albums';
                return `Photos / ${currentAlbum.name}`;
            };

            return (
                <div className="absolute top-12 left-4 right-4 bottom-24 md:left-32 md:right-32 md:top-28 md:bottom-44 glass-window rounded-2xl flex flex-col overflow-hidden shadow-2xl animate-pop z-10 border border-white/40">
                    <div className={`h-11 bg-gradient-to-r ${headerGradient} border-b border-white/50 flex items-center justify-between px-5 shrink-0 select-none`}>
                        <div className="flex gap-2.5">
                            <div className="w-3.5 h-3.5 rounded-full bg-red-400 shadow-inner cursor-pointer hover:bg-red-500 transition-colors" onClick={onClose}></div>
                            <div className="w-3.5 h-3.5 rounded-full bg-yellow-400 shadow-inner"></div>
                            <div className="w-3.5 h-3.5 rounded-full bg-green-400 shadow-inner"></div>
                        </div>
                        <div className="flex items-center gap-2 text-gray-600 text-[11px] font-bold uppercase tracking-[0.2em] truncate px-4">
                            <Icon path={ICONS.library} className="w-3.5 h-3.5 shrink-0" />
                            <span className="truncate">{getBreadcrumb()}</span>
                        </div>
                        <div className="w-10"></div>
                    </div>
                    <div className="flex flex-1 overflow-hidden">
                        {/* ä¾§è¾¹æ èƒŒæ™¯é€æ˜åº¦é™ä½ */}
                        <div className="w-52 bg-white/30 border-r border-white/40 hidden md:flex flex-col p-5 gap-2.5 text-sm text-gray-700 font-pixel font-bold">
                            <div className="font-bold text-gray-500 text-[10px] uppercase mb-1 px-2 tracking-widest">Navigation</div>
                            <div 
                                className={`flex items-center gap-3 px-4 py-2 rounded-xl cursor-pointer transition-all duration-300 ${activeTab === 'photos' ? sidebarHighlight + ' shadow-sm translate-x-1' : 'hover:bg-white/40'}`}
                                onClick={handlePhotoTabClick}
                            >
                                <Icon path={ICONS.library} className="w-4 h-4" /> ç…§ç‰‡åº“
                            </div>
                            <div 
                                className={`flex items-center gap-3 px-4 py-2 rounded-xl cursor-pointer transition-all duration-300 ${activeTab === 'readme' ? sidebarHighlight + ' shadow-sm translate-x-1' : 'hover:bg-white/40'}`}
                                onClick={() => onTabChange('readme')}
                            >
                                ğŸ“– ä½¿ç”¨è¯´æ˜
                            </div>
                            <div className="mt-auto pt-4 border-t border-white/40 space-y-2">
                                <div className="flex items-center gap-3 hover:bg-white/40 px-4 py-2 rounded-xl cursor-pointer transition-colors opacity-70"><Icon path={ICONS.home} className="w-4 h-4" /> æ¡Œé¢ä¸­å¿ƒ</div>
                                <div className="flex items-center gap-3 hover:bg-white/40 px-4 py-2 rounded-xl cursor-pointer transition-colors opacity-70"><Icon path={ICONS.cloud} className="w-4 h-4 text-blue-500" /> å­˜å‚¨ç©ºé—´</div>
                            </div>
                        </div>
                        <div className="flex-1 bg-transparent scroll-container overflow-y-auto p-6 md:p-10">
                            {activeTab === 'photos' ? (
                                !currentAlbum ? (
                                    <div className="animate-in fade-in zoom-in duration-300">
                                        <h2 className="text-gray-500 font-bold mb-6 text-sm uppercase tracking-wider opacity-80">Albums</h2>
                                        <div className="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-5 gap-6">
                                            {albums.map((album, idx) => (
                                                <div 
                                                    key={idx}
                                                    className="flex flex-col items-center gap-2 group cursor-pointer"
                                                    onClick={() => setCurrentAlbum(album)}
                                                >
                                                    <div className={`w-20 h-16 rounded-xl flex items-center justify-center transition-all group-hover:scale-105 shadow-sm border border-white/40 relative overflow-hidden ${folderColor}`}>
                                                         <div className="absolute top-0 right-0 p-1 opacity-20">
                                                            <Icon path={ICONS.folder} className="w-12 h-12" />
                                                         </div>
                                                         <Icon path={ICONS.library} className="w-8 h-8 z-10" />
                                                    </div>
                                                    <span className="text-xs font-bold text-gray-700 bg-white/40 px-2 py-0.5 rounded shadow-sm max-w-full truncate">{album.name}</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                ) : (
                                    <div className="flex flex-col h-full animate-in slide-in-from-right-4 duration-300">
                                        <div className="flex items-center gap-2 mb-6 text-gray-600 text-sm font-bold">
                                            <button 
                                                onClick={() => setCurrentAlbum(null)}
                                                className="hover:bg-white/40 px-3 py-1 rounded-lg transition-colors flex items-center gap-1 border border-transparent hover:border-white/40"
                                            >
                                                <span className="text-lg leading-none mb-0.5">â†</span> è¿”å›
                                            </button>
                                            <span className="opacity-30">/</span>
                                            <span className={theme === 'zzai' ? 'text-pink-600' : 'text-blue-600'}>{currentAlbum.name}</span>
                                        </div>
                                        {currentAlbum.photos.length > 0 ? (
                                            <div className="columns-1 sm:columns-2 lg:columns-3 gap-8 space-y-8">
                                                {currentAlbum.photos.map((p, pIdx) => (
                                                    <div key={pIdx} onClick={() => setSelectedPhoto(p)} className="break-inside-avoid group cursor-pointer relative">
                                                        <div className="absolute -top-3 left-1/2 -translate-x-1/2 w-14 h-7 bg-white/30 rotate-2 z-20 shadow-sm pointer-events-none rounded"></div>
                                                        <div className="bg-white/90 p-3 pb-8 shadow-lg border border-white/60 hover:shadow-2xl transition-all transform hover:-rotate-1 duration-300 rounded-sm">
                                                            <div className="bg-gray-100 overflow-hidden rounded-sm min-h-[150px] flex items-center justify-center">
                                                                <img 
                                                                    src={p.url} 
                                                                    className="w-full h-auto" 
                                                                    alt={p.title}
                                                                    loading="lazy"
                                                                    onError={(e) => { 
                                                                        e.target.onerror = null; 
                                                                        e.target.src='https://via.placeholder.com/300x400/fff/ffb7c5?text=Load+Error'; 
                                                                    }} 
                                                                />
                                                            </div>
                                                            <div className="text-center mt-3 font-hand text-gray-600 text-base break-words px-2">{p.title}</div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        ) : (
                                            <div className="flex flex-col items-center justify-center h-64 text-gray-500 font-hand gap-4">
                                                <div className="text-4xl">ğŸ“·</div>
                                                <p>è¿™ä¸ªç›¸å†Œæ˜¯ç©ºçš„å“¦</p>
                                            </div>
                                        )}
                                    </div>
                                )
                            ) : (
                                <div className="font-hand text-gray-800 space-y-6 text-lg animate-in fade-in duration-300">
                                    <h2 className={`text-3xl font-black border-b-2 pb-3 ${theme === 'zzai' ? 'border-pink-300 text-pink-600' : 'border-blue-300 text-blue-600'}`}>ğŸŒ¸ Zzai OS å®Œæ•´æŒ‡å—</h2>
                                     
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <section className="bg-white/30 p-5 rounded-2xl border border-white/40 shadow-sm">
                                            <h3 className="font-bold mb-3 flex items-center gap-2">ğŸ“ å¤šç›¸å†Œæ”¯æŒ (New!)</h3>
                                            <ul className="space-y-2 text-sm">
                                                <li>â€¢ <b>æ–‡ä»¶å¤¹ç®¡ç†ï¼š</b> ç°åœ¨æ”¯æŒå¤šä¸ªæœ¬åœ°æ–‡ä»¶å¤¹äº†ï¼</li>
                                                <li>â€¢ <b>å¦‚ä½•é…ç½®ï¼š</b> åœ¨ images ç›®å½•ä¸‹åˆ›å»ºä¸åŒæ–‡ä»¶å¤¹ï¼ˆå¦‚ travel, petsï¼‰ï¼Œå¹¶åœ¨ photos.js ä¸­é…ç½®å³å¯ã€‚</li>
                                                <li>â€¢ <b>å¯¼èˆªï¼š</b> ç‚¹å‡»â€œç…§ç‰‡åº“â€å·¦ä¸Šè§’çš„è¿”å›æŒ‰é’®å¯åœ¨ä¸åŒç›¸å†Œé—´åˆ‡æ¢ã€‚</li>
                                            </ul>
                                        </section>

                                        <section className="bg-white/30 p-5 rounded-2xl border border-white/40 shadow-sm">
                                            <h3 className="font-bold mb-3 flex items-center gap-2">ğŸ¾ åƒç´ çŒ« (Pixel Cat)</h3>
                                            <ul className="space-y-2 text-sm">
                                                <li>â€¢ <b>è‡ªä¸»è¡Œä¸ºï¼š</b> ä¼šéšæœºå·¡é€»ã€å‘å‘†ã€åä¸‹ï¼ˆ16åº¦å€¾æ–œï¼‰æˆ–è¶´ä¸‹ä¼‘æ¯ã€‚</li>
                                                <li>â€¢ <b>æ™ºèƒ½æ°”æ³¡ï¼š</b> è¯´è¯æ—¶æ°”æ³¡ä¼šéšçŒ«å’ªåŠ¨ä½œä½ç§»ã€‚</li>
                                                <li>â€¢ <b>ç‚¹å‡»äº’åŠ¨ï¼š</b> é¼ æ ‡ç‚¹å‡»çŒ«å’ªï¼Œå®ƒä¼šæ„Ÿåº”åˆ°å¹¶å›åº”ç‰¹æ®Šå¯¹è¯ã€‚</li>
                                            </ul>
                                        </section>
                                        
                                        <section className="bg-white/30 p-5 rounded-2xl border border-white/40 shadow-sm">
                                            <h3 className="font-bold mb-3 flex items-center gap-2">âœ¨ ä»»åŠ¡æ ä¸ç‰¹æ•ˆ</h3>
                                            <ul className="space-y-2 text-sm">
                                                <li>â€¢ <b>FILES æŒ‰é’®ï¼š</b> ç‚¹å‡»å¯ä¸€é”®éšè—/æ¢å¤ä¸»çª—å£ã€‚</li>
                                                <li>â€¢ <b>ä¸»é¢˜åˆ‡æ¢ï¼š</b> ç‚¹å‡»æ¡Œé¢ä¸Šçš„â€œæ¢ä¸ªå¿ƒæƒ…â€åˆ‡æ¢ç²‰è‰²/è“è‰²ä¸»é¢˜ã€‚</li>
                                                <li>â€¢ <b>é¼ æ ‡å°¾è¿¹ï¼š</b> ç§»åŠ¨é¼ æ ‡ä¼šäº§ç”Ÿéšä¸»é¢˜è‰²å˜åŒ–çš„æ˜Ÿæ˜Ÿç²’å­ã€‚</li>
                                            </ul>
                                        </section>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        function App() {
            const [albums, setAlbums] = useState([]);
            const [currentAlbum, setCurrentAlbum] = useState(null);
            const [selectedPhoto, setSelectedPhoto] = useState(null);
            const [isWindowOpen, setIsWindowOpen] = useState(true);
            const [activeTab, setActiveTab] = useState('photos');
            
            // ä¿®æ”¹è¿™é‡Œï¼šåˆå§‹åŒ–æ—¶ä¼˜å…ˆä» localStorage è¯»å–ä¸»é¢˜
            const [theme, setTheme] = useState(() => {
                const savedTheme = localStorage.getItem('zzai-theme');
                return savedTheme ? savedTheme : 'zzai';
            });

            // æ–°å¢ï¼šç›‘å¬ theme å˜åŒ–å¹¶ä¿å­˜åˆ° localStorage
            useEffect(() => {
                localStorage.setItem('zzai-theme', theme);
            }, [theme]);

            useEffect(() => {
                // ----------------------------------------------------
                // ğŸ“‚ æ ¸å¿ƒé€»è¾‘ï¼šåŠ è½½å¤šç›¸å†Œæ•°æ®
                // ----------------------------------------------------
                const BASE_PATH = 'images/';

                let albumsData = [];

                if (window.MY_ALBUMS && Array.isArray(window.MY_ALBUMS)) {
                    // æ–°ç‰ˆï¼šè¯»å–ç›¸å†Œåˆ—è¡¨
                    albumsData = window.MY_ALBUMS.map(albumConfig => {
                        const folderName = albumConfig.folder || '';
                        
                        // å¤„ç†è¯¥ç›¸å†Œä¸‹çš„ç…§ç‰‡
                        const photos = (albumConfig.files || []).map((filename, i) => {
                            // æ„é€ è·¯å¾„ï¼š images/æ–‡ä»¶å¤¹å/æ–‡ä»¶å
                            // å¦‚æœæ–‡ä»¶åå·²ç»æ˜¯ http å¼€å¤´ï¼Œå°±ä¸åŠ è·¯å¾„
                            const isWebUrl = filename.startsWith('http') || filename.startsWith('data:');
                            const fullUrl = isWebUrl 
                                ? filename 
                                : `${BASE_PATH}${folderName}/${filename}`; // e.g. images/travel/1.jpg

                            // æå–æ ‡é¢˜
                            let title = 'æœªå‘½å';
                            try {
                                const parts = filename.split('/');
                                const rawName = parts[parts.length - 1]; 
                                title = rawName.split('.')[0] || 'Image';
                                title = decodeURIComponent(title);
                            } catch (e) {}

                            return { url: fullUrl, title: title };
                        });

                        return {
                            name: albumConfig.name || folderName || 'æœªå‘½åç›¸å†Œ',
                            photos: photos
                        };
                    });
                } else if (window.MY_PHOTOS) {
                    // å…¼å®¹æ—§ç‰ˆï¼šå¦‚æœåªæœ‰æ—§çš„ MY_PHOTOS æ•°ç»„ï¼Œå°±æŠŠå®ƒå½“æˆä¸€ä¸ªâ€œé»˜è®¤ç›¸å†Œâ€
                    const legacyPhotos = window.MY_PHOTOS.map((filename, i) => {
                         const fullUrl = (filename.startsWith('http') || filename.startsWith('data:'))
                            ? filename 
                            : BASE_PATH + filename;
                         return { url: fullUrl, title: 'Photo ' + (i+1) };
                    });
                    
                    albumsData = [{
                        name: "é»˜è®¤ç›¸å†Œ",
                        photos: legacyPhotos
                    }];
                } else {
                    // ç©ºçŠ¶æ€
                     albumsData = [{
                        name: "ç¤ºä¾‹ç›¸å†Œ",
                        photos: []
                    }];
                }

                setAlbums(albumsData);
            }, []);

            const themeBtnColor = theme === 'zzai' ? 'from-pink-500 to-pink-400' : 'from-blue-500 to-blue-400';
            const accentColor = theme === 'zzai' ? 'text-zzai-dark' : 'text-sky-dark';
            const dotColor = theme === 'zzai' ? 'bg-zzai-dark' : 'bg-sky-dark';

            return (
                <div className={`desktop-wallpaper w-screen h-screen relative transition-all duration-700 ${theme === 'zzai' ? 'theme-zzai' : 'theme-sky'}`}>
                    <CursorEffect theme={theme} />
                    
                    <div className="absolute top-8 left-8 flex flex-col gap-8 z-0">
                        <DesktopIcon label="æˆ‘çš„ç”µè„‘" icon={ICONS.monitor} theme={theme} isSvg={true} />
                        <DesktopIcon label="å›æ”¶ç«™" icon="ğŸ—‘ï¸" theme={theme} />
                        <DesktopIcon label="ç…§ç‰‡åº“" icon="ğŸŒ¸" theme={theme} onClick={() => { setIsWindowOpen(true); setActiveTab('photos'); }} />
                        <DesktopIcon label="è¯´æ˜ä¹¦" icon="ğŸ“–" theme={theme} onClick={() => { setIsWindowOpen(true); setActiveTab('readme'); }} />
                        <DesktopIcon label="æ¢ä¸ªå¿ƒæƒ…" icon="ğŸ¨" theme={theme} onClick={() => setTheme(t => t === 'zzai' ? 'sky' : 'zzai')} />
                    </div>

                    <TodoMemo />
                    <RealisticPixelCat />
                    
                    {isWindowOpen && (
                        <MainAppWindow 
                            activeTab={activeTab} 
                            onTabChange={setActiveTab} 
                            onClose={() => setIsWindowOpen(false)} 
                            albums={albums}
                            currentAlbum={currentAlbum}
                            setCurrentAlbum={setCurrentAlbum}
                            setSelectedPhoto={setSelectedPhoto}
                            theme={theme}
                        />
                    )}

                    <nav className="fixed bottom-0 left-0 w-full h-14 bg-white/60 backdrop-blur-xl border-t border-white/30 flex items-center justify-center sm:justify-between px-8 z-50">
                        <div className="flex gap-6 items-center h-full">
                            <div className={`w-9 h-9 rounded-full bg-gradient-to-tr ${themeBtnColor} shadow-md flex items-center justify-center text-white cursor-pointer hover:rotate-12 transition-transform`}>
                                <Icon path={ICONS.os} className="w-5 h-5" />
                            </div>
                            <div className="h-6 w-[1px] bg-gray-400/30 hidden sm:block"></div>
                            
                            <div 
                                className={`relative flex items-center gap-2.5 px-4 h-[75%] rounded-xl transition-all duration-500 group cursor-pointer
                                    ${isWindowOpen ? 'bg-white/40 shadow-sm ' + accentColor : 'text-gray-500 hover:text-gray-700 hover:bg-white/20'}
                                `}
                                onClick={() => setIsWindowOpen(!isWindowOpen)}
                            >
                                <Icon path={ICONS.library} className="w-5 h-5" />
                                <span className="font-pixel font-bold text-xs hidden sm:block tracking-wider uppercase">Files</span>
                                {isWindowOpen && (
                                    <div className={`absolute -bottom-1.5 left-1/2 -translate-x-1/2 w-1.5 h-1.5 rounded-full shadow-[0_0_8px] ${dotColor} shadow-current`}></div>
                                )}
                            </div>
                        </div>
                        <div className="font-pixel text-gray-500 text-xs hidden sm:flex gap-4 items-center">
                            <span className={`hidden sm:inline-block animate-pulse uppercase tracking-[0.2em] font-black ${theme === 'zzai' ? 'text-pink-500' : 'text-blue-500'}`}>
                                â— System Online
                            </span>
                            <div className="bg-white/50 px-4 py-1.5 rounded-full shadow-sm border border-white/30 text-gray-800 font-bold tabular-nums">
                                {new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                            </div>
                        </div>
                    </nav>

                    {selectedPhoto && (
                        <div className="fixed inset-0 z-[200] flex items-center justify-center p-6 backdrop-blur-md animate-in fade-in duration-300">
                            <div className="absolute inset-0 bg-black/25" onClick={() => setSelectedPhoto(null)}></div>
                            <div className="relative bg-white/95 p-2.5 shadow-2xl rounded-2xl animate-pop max-w-5xl w-full overflow-hidden border-4 border-white/80">
                                <button 
                                    className={`absolute top-4 right-4 w-9 h-9 bg-gradient-to-br ${themeBtnColor} text-white rounded-full font-bold shadow-lg z-10 flex items-center justify-center hover:scale-110 transition-transform`} 
                                    onClick={() => setSelectedPhoto(null)}
                                >âœ•</button>
                                <img src={selectedPhoto.url} className="w-full h-auto max-h-[80vh] object-contain rounded-lg" onError={(e) => { e.target.src='https://via.placeholder.com/300x400/fff/ffb7c5?text=Load+Error'; }} />
                                <div className="text-center py-4 font-hand text-gray-600 text-xl">{selectedPhoto.title}</div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
